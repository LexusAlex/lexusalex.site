---
title: Stateful и Stateless архитектуры
description: >-
  Чем отличаются Stateful и Stateless архитектуры
author: alex
date: 2055-12-31 22:44:00 +0300
categories: [Basics Api]
tags: [state stateful stateless]
image:
  path: /assets/img/posts/regexp.png
  alt: 
---

## State

Важно понимать, что такое **состояние** (`state`).

Система или объект в определенный момент времени может находиться в определенном состоянии.

Например, мы общаемся бинарным языком `0` или `1`. Состояние объекта не может быть одновременно равно и `0` и `1`, либо `да` либо `нет`.
Теперь нам показывают 5 цифр и каждый раз мы пишем результат `да` или `нет` на лист бумаги.

````text
0 - нет
1 - да
0 - нет
0 - нет
1 - да
````

Это и есть состояние, наш ответ полностью зависит от числа которое нам покажут.

Состояние - это сохраненные данные, которые используются и хранятся приложением.

## Stateful

`Stateful` приложение запоминает - это приложение которое, хранит данные, то есть состояние.

Например, аутентификация на сайте. 

Для того, зайти на сайт нужно передать на сервер свой логин и пароль.
Веб сервис хранит данные для аутентификации, такой сервис называют `stateful`. После аутентификации мы пользуемся сервисом, который знает о нас, что мы в него вошли.
То есть все следующие действия зависят от предыдущих. Веб сервис хранит сессии пользователей, отсюда появляется проблема переноса сервиса на другой сервер, приходится переносить и состояние пользователей, то есть и сессии.

### Проблемы хранения состояния

Главная проблема при архитектуре, где состояние определяется клиентов - это хранение состояния в множестве незавершенных сессий и транзакций, отсюда возникают ряд вопросов

- Как долго сервис должен держать соединение открытым?
- Как проверить что клиент отключен?
- Как откатить действия пользователя, если что-то пошло не так?


TCP - хранит состояние

## Stateless

`Stateless` — это когда любой ответ сервера не зависит от какого-либо состояния.

То есть каждый запрос является автономным и не зависящий от предыдущих запросов.

HTTP протокол без хранения состояния.

## Идея

Основная идея, которая лежит в основе чего-то, что сохраняет состояние, заключается в том, что это что-то обладает идеальной памятью или знает все о предыдущих вызовах и запросах.

Когда мы заходим на сайт, мы генерируем состояние, оно в свою очередь генерирует сессию которая храниться на сервере, это `Stateful` система. 
Но если состояние мы полностью передаем клиентом, то это уже `Stateless`, например можем для этого использовать `cookie` или `jwt`. Тогда мы всегда вместе с запросом отправляем информацию для его выполнения, при этом на сервере ничего не сохраняя. `Stateless` система зависит только от тех данных которые мы ее передали.


http://rsdn.org/forum/design/2951941.1
