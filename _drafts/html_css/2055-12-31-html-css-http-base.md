---
title: Http. База
description: >-
  Введение в протокол http. То на чем все строиться
author: alex
date: 2055-03-26 14:20:00 +0300
categories: [Http,Html]
image:
  path: /assets/img/posts/main/html.png
  lqip: data:image/webp;base64,UklGRpoAAABXRUJQVlA4WAoAAAAQAAAADwAABwAAQUxQSDIAAAARL0AmbZurmr57yyIiqE8oiG0bejIYEQTgqiDA9vqnsUSI6H+oAERp2HZ65qP/VIAWAFZQOCBCAAAA8AEAnQEqEAAIAAVAfCWkAALp8sF8rgRgAP7o9FDvMCkMde9PK7euH5M1m6VWoDXf2FkP3BqV0ZYbO6NA/VFIAAAA
  alt: Введение в протокол http. То на чем все строиться
---

## Базовые понятия

`Http` - Протокол для обмена данными в интернете.

`client` и `server` обмениваются отдельными сообщениями. Клиент отправляет запросы `request`, а сервере возвращает ответ `response`.

Принцип `request` < - > `response`, в две стороны.

Процесс может быть `server` для нас, но для других сайтов это может быть `client`.

> Http является расширяемым протоколом
{: .prompt-info }

Запросы отправляются клиентом, клиентом может быть что угодно браузер, консольная утилита, поисковый робот.

Между клиентом и сервером могут быть посредники `proxy`, которые могут как то модифицировать и фильтровать запрос.

Чтобы клиенту сделать запрос ему нужно знать `ip` адрес сервера, куда нужно отправлять запрос (про `dns` пока опустим). 

После этого создается виртуальный канал связи. Помимо `ip` адреса внутри одного сервера есть система виртуальных портов от `1 ... 65535`. 
Любой из портов может забронировать только один процесс. Процесс может занимать несколько портов, но один порт = один процесс.

Например, к сайту `google.com`, можно обратится так http://google.com:80 и так https://google.com:443

Эти порты зарезервированы.

На клиентском компьютере тоже есть порты, но тут ничего не зарезервировано, выдаются порты с номерами больше `1000`
обычно от `49152` до `65535` к примеру Клиент - `192.168.1.100:51234` сервер - `93.184.216.34:80`.

Чтобы это увидеть в `linux` системах выполним команду:

````shell
netstat -an | grep ESTABLISHED
tcp        0      0 192.168.88.252:59038    5.255.255.77:443        ESTABLISHED
tcp        0      0 192.168.88.252:54816    34.36.137.203:443       ESTABLISHED
tcp        0      0 192.168.88.252:54828    34.120.208.123:443
````

`Http` протокол не имеет состояние, но может сохранять пользовательскую сессию используя "Куки".

## Клиент

Клиент - это устройство инициализирующее запрос, например браузер. Чтобы получить ответ, браузер выполняет запрос на сервер.
Помимо `html` браузер так же запрашивает скрипты, стили, изображения, видео. Далее все это склеиваться в один документ и показывается пользователю.

## Сервер

Сервер - это виртуальная машина (может быть несколько машин) которая обслуживает запросы клиентов. 
Несколько серверов могут быть расположены на одной машине.

Прокси - это промежуточный узел, который может кешировать, фильтровать, протоколировать, аутентифицировать запрос клиента, прежде чем он попадет на сервер.

## Запрос-ответ

Теперь посмотрим как происходит запрос:

1. Открывается `tcp` соединение, которое будет использоваться для цикла запрос-ответ. Может быть открыто несколько соединений
2. Отправка `http` сообщения на сервер
````http
GET / HTTP/1.1
Host: test.test.com
````
3. Сервер анализирует запрос и возвращает результат
````http
HTTP/1.1 200 OK
Server: Apache

<!doctype html>… (here come the 29769 bytes of the requested web page)
````
4. Закрытие или переиспользование соединения.

## Версии http 

- `1.1`
- `2` - добавлены оптимизация, сжатие, мультиплексирование

## Запрос

Можно было увидеть из примера выше запросы имеют специальный формат `GET / HTTP/1.1`, где

- Метод запроса, например `GET` получение ресурса, `POST` отправка формы, и другие
- Путь к ресурсу
- Версия протокола
- Заголовки запроса
- Тело запроса

## Ответ

Ответ приходит в следующем формате `HTTP/1.1 200 OK`, где указывается

- Версия протокола
- Код ответа сервера
- Сообщение кода ответа сервера
- Заголовки ответа
- Тело ответа


Query params

## Запрос
## Ответ

