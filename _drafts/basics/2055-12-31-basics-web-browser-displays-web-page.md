---
title: Отображение веб страницы браузером
description: >-
  Рассмотрим процесс отображения веб страницы браузером
author: alex
date: 2055-06-08 22:40:00 +0300
categories: [Basics]
tags: [js,html,css]
image:
  path: /assets/img/posts/main/javascript.png
  alt: Отображение веб страницы браузером
---

Важно для нас проследить каким образом формируется в браузере запрашиваемая `html` страница, после того как было установлено соединение с веб-сервером.

## Запросы

Браузер от имени пользователя отправляет запрос на веб-сервер. Чаще всего запрашивается `html` файл.

Когда запрос достиг сервера, сервер начинает отправлять ответ с заголовками и содержимым `html` файла.

В первичном файле содержатся ссылки на другие ресурсы - это стили, скрипты, изображения, аудио, видео и др.

## Обработка данных

Как только часть данных пришла, браузер сразу же начинает обработку информации - это называется **парсингом**.

Для того чтобы отрисовать данные браузер распознает переданные данные и преобразует их в `DOM` и `CSSOM`.

### DOM

`DOM` - это объектная модель документа, так как браузер работает не с текстом, а абстрактным представлением документа `DOM` деревом.

То есть для документа строится дерево его элементов.

````html
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Title</title>
</head>
<body>

</body>
</html>
````

Для того чтобы манипулировать элементами, используются разные `Javascript API`.

Браузер начинает обрисовывать страницу с данными которые уже доступны.

Если документ формирован правильно, парсер обработает данные быстро.

Во время парсинга, браузер запрашивает другие ресурсы, например изображения или `css`. В это же время обработка `html` продолжается.

Но если подключается тег `script` без параметров `async` или `defer`, такой скрипт блокирует обработку `html`, до завершения их загрузки.

> Важно понимать, что браузер разбирает html сверху вниз, слева направо, поэтому скрипты, которые работают с разметкой должны быть подключены только после формирования всего html.
{: .prompt-info }

Как можно было понять построение `DOM` дерева документа, это узкое место в производительности, поэтому в браузере есть специальный механизм предзагрузки.

Он находит скрипты с `async` или `defer` и загружает их параллельно с `html`.

В то же время когда ожидается получения `css` блокируется работа `javascript`, так как через `javascript` происходит выборка `css` селекторов.

### CSSOM

По аналогии с `DOM`, как только браузер загрузил фаил стилей, он строит `CSSOM` дерево (карту стилей), с которой он может работать.

Браузер проходит по правилам `css` и создает дерево основываясь на `css` селекторах.

Сам процесс построения `CSSOM` происходит очень быстро, это даже меньше чем `DNS` запрос.

Далее когда `CSSOM` обработан, должен быть исполнен `javascript`. Помимо этого браузер так же строит дерево доступности.

## Рендер

Когда `CSSOM` и `DOM` готовы, пришло время процедуры рендера.

Рендер включает в себя несколько этапов

- Стилизация
- Компоновка
- Композиция
- Отрисовка

### Стилизация

`CSSOM` и `DOM` образуют дерево рендера, которое впоследствии используется для расчета положения видимых элементов.

То есть идет проход по всему дереву с выявлением видимых узлов.

Так как каждый узел который нужно отобразить имеет свои правила в `CSSOM`, он содержит вычисленные стили.

### Компоновка элементов

https://developer.mozilla.org/ru/docs/Web/Performance/Guides/How_browsers_work#%D0%BA%D0%BE%D0%BC%D0%BF%D0%BE%D0%BD%D0%BE%D0%B2%D0%BA%D0%B0_layout
https://doka.guide/tools/how-the-browser-creates-pages/#render-tree
